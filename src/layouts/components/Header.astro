---
import HeaderLink from './HeaderLink.astro';

const menu = [
	{
		link: '/about/',
		label: 'About'
	},
	{
		link: '/blog/',
		label: 'Blog'
	},
	{
		link: '/projects/',
		label: 'Projects'
	}
];
---

<header id='site-header' class='flex items-center w-full transition-all duration-500 z-50 border-(--soft-border-color) backdrop-blur-xl bg-white/90 dark:bg-zinc-900/90 sticky top-0 shadow-sm'>
	<div class='container mx-auto px-4'>
		<nav class='flex gap-4 items-center justify-between py-3'>
			<!-- Logo/Name -->
			<h2 class='m-0'>
				<a href='/' class='flex gap-3 items-center text-xl font-bold tracking-tight transition-all duration-300 group'> 
					<span class='bg-gradient-to-r from-blue-600 to-cyan-500 bg-clip-text text-transparent group-hover:from-purple-600 group-hover:to-blue-500 transition-all duration-500'>Tran Phuc Hau</span>
				</a>
			</h2>
			
			<!-- Mobile menu button -->
			<button id='menu-toggle' class='p-2 lg:hidden hover:bg-blue-50 dark:hover:bg-zinc-800 rounded-lg transition-all duration-300' aria-label='Toggle menu'>
				<svg
					xmlns='http://www.w3.org/2000/svg'
					class='icon icon-tabler icon-tabler-menu-2 w-6 h-6 text-zinc-700 dark:text-zinc-300'
					width='24'
					height='24'
					viewBox='0 0 24 24'
					stroke-width='2'
					stroke='currentColor'
					fill='none'
					stroke-linecap='round'
					stroke-linejoin='round'
				>
					<path stroke='none' d='M0 0h24v24H0z' fill='none'></path>
					<path d='M4 6l16 0'></path>
					<path d='M4 12l16 0'></path>
					<path d='M4 18l16 0'></path>
				</svg>
			</button>
			
			<!-- Desktop Navigation -->
			<ul class='hidden lg:flex items-center gap-8'>
				{
					menu.map((item) => (
						<li>
							<HeaderLink href={item.link} class='text-zinc-700 dark:text-zinc-300 hover:text-blue-600 dark:hover:text-blue-400 font-medium transition-all duration-300 px-2 py-1 rounded-lg hover:bg-blue-50/50 dark:hover:bg-zinc-800/50 relative'>
								{item.label}
								<span class='absolute bottom-0 left-1/2 w-0 h-0.5 bg-blue-500 transition-all duration-300 group-hover:left-0 group-hover:w-full'></span>
							</HeaderLink>
						</li>
					))
				}
			</ul>
			
			<!-- Social Icons & Theme Toggle -->
			<div class='flex items-center gap-1'>
				<button id='themeToggle' class='p-2 hover:bg-blue-50 dark:hover:bg-zinc-800 rounded-lg transition-all duration-300' aria-label='Toggle theme'>
					<svg
						xmlns='http://www.w3.org/2000/svg'
						class='sun w-5 h-5 text-zinc-700 dark:text-zinc-300'
						width='24'
						height='24'
						viewBox='0 0 24 24'
						stroke-width='2'
						stroke='currentColor'
						fill='none'
						stroke-linecap='round'
						stroke-linejoin='round'
					>
						<path stroke='none' d='M0 0h24v24H0z' fill='none'></path>
						<circle cx='12' cy='12' r='4'></circle>
						<path
							d='M3 12h1m8 -9v1m8 0h1m-9 8v1m-6.4 -12.4l-.7 .7m12.1 -.7l.7 .7m-9.4 7.1l-.7 .7m12.1 -.7l.7 .7'
						></path>
					</svg>
					<svg
						xmlns='http://www.w3.org/2000/svg'
						class='moon w-5 h-5 text-zinc-700 dark:text-zinc-300 hidden'
						width='24'
						height='24'
						viewBox='0 0 24 24'
						stroke-width='2'
						stroke='currentColor'
						fill='none'
						stroke-linecap='round'
						stroke-linejoin='round'
					>
						<path stroke='none' d='M0 0h24v24H0z' fill='none'></path>
						<path d='M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z'></path>
					</svg>
				</button>
				
				<a class='p-2 dark:hidden hover:bg-blue-50 dark:hover:bg-zinc-800 rounded-lg transition-all duration-300' href='https://github.com/hautph' target='_blank' aria-label='GitHub'>
					<img src='/assets/img/github-mark.svg' width='20' height='20' alt='GitHub' loading='lazy' decoding='async' class='transition-transform duration-300 hover:scale-110' />
				</a>
				<a class='p-2 hidden dark:block hover:bg-blue-50 dark:hover:bg-zinc-800 rounded-lg transition-all duration-300' href='https://github.com/hautph' target='_blank' aria-label='GitHub'>
					<img src='/assets/img/github-mark-white.svg' width='20' height='20' alt='GitHub' loading='lazy' decoding='async' class='transition-transform duration-300 hover:scale-110' />
				</a>
				<a class='p-2 hover:bg-blue-50 dark:hover:bg-zinc-800 rounded-lg transition-all duration-300' href='https://www.linkedin.com/in/hautph' target='_blank' aria-label='LinkedIn'>
					<svg width='20' height='20' fill='currentColor' viewBox='0 0 24 24' aria-hidden='true' class='text-zinc-700 dark:text-zinc-300 transition-transform duration-300 hover:scale-110'>
						<path d='M19 0h-14c-2.76 0-5 2.24-5 5v14c0 2.76 2.24 5 5 5h14c2.76 0 5-2.24 5-5v-14c0-2.76-2.24-5-5-5zm-11 19h-3v-9h3v9zm-1.5-10.28c-.97 0-1.75-.79-1.75-1.75s.78-1.75 1.75-1.75 1.75.79 1.75 1.75-.78 1.75-1.75 1.75zm15.5 10.28h-3v-4.5c0-1.08-.02-2.47-1.5-2.47-1.5 0-1.73 1.17-1.73 2.39v4.58h-3v-9h2.89v1.23h.04c.4-.75 1.38-1.54 2.84-1.54 3.04 0 3.6 2 3.6 4.59v4.72z'></path>
					</svg>
				</a>
			</div>
		</nav>
		
		<!-- Mobile Navigation (Hidden by default) -->
		<div id='mobile-menu' class='lg:hidden hidden py-4 border-t border-zinc-200 dark:border-zinc-700'>
			<ul class='space-y-3'>
				{
					menu.map((item) => (
						<li>
							<HeaderLink href={item.link} class='block py-2 px-4 text-zinc-700 dark:text-zinc-300 hover:text-blue-600 dark:hover:text-blue-400 font-medium rounded-lg hover:bg-blue-50/50 dark:hover:bg-zinc-800/50'>
								{item.label}
							</HeaderLink>
						</li>
					))
				}
			</ul>
		</div>
	</div>

	<style is:global>
		.dark #themeToggle .sun {
			display: none;
		}
		.dark #themeToggle .moon {
			display: block;
		}
		
		/* Header scroll effect */
		#site-header {
			transition: all 0.4s cubic-bezier(0.22, 0.61, 0.36, 1);
		}
		
		.scrolled #site-header {
			box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
			background-color: rgba(255, 255, 255, 0.95);
			padding-top: 0.5rem;
			padding-bottom: 0.5rem;
		}
		
		.dark .scrolled #site-header {
			background-color: rgba(24, 24, 27, 0.95);
		}
	</style>

	<script is:inline>
		function sendMessage(message) {
			const iframe = document.querySelector('iframe.giscus-frame');
			if (!iframe) return;
			iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
		}

		const handleToggleClick = () => {
			const isDark = document.documentElement.classList.contains('dark');
			const newTheme = isDark ? 'light' : 'dark';
			window.setTheme(newTheme);
			if (newTheme === 'dark') {
				sendMessage({ setConfig: { theme: 'dark_dimmed' } });
			} else {
				sendMessage({ setConfig: { theme: 'light' } });
			}
			
			// Toggle moon/sun icons
			const sunIcon = document.querySelector('#themeToggle .sun');
			const moonIcon = document.querySelector('#themeToggle .moon');
			if (sunIcon && moonIcon) {
				sunIcon.classList.toggle('hidden');
				moonIcon.classList.toggle('hidden');
			}
		};
		document.getElementById('themeToggle')?.addEventListener('click', handleToggleClick);
		
		// Mobile menu toggle
		document.getElementById('menu-toggle')?.addEventListener('click', () => {
			const mobileMenu = document.getElementById('mobile-menu');
			if (mobileMenu) {
				mobileMenu.classList.toggle('hidden');
			}
		});

		// Header scroll effect
		window.addEventListener('scroll', () => {
			if (window.scrollY > 50) {
				document.body.classList.add('scrolled');
			} else {
				document.body.classList.remove('scrolled');
			}
		});
		
		// Close mobile menu when clicking on a link
		document.querySelectorAll('#mobile-menu a').forEach(link => {
			link.addEventListener('click', () => {
				const mobileMenu = document.getElementById('mobile-menu');
				if (mobileMenu) {
					mobileMenu.classList.add('hidden');
				}
			});
		});
	</script>
</header>